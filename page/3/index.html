<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/08/rsync-by-log/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/03/08/rsync-by-log/" class="post-title-link" itemprop="url">rsync by log</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-03-08 11:24:06" itemprop="dateCreated datePublished" datetime="2016-03-08T11:24:06+08:00">2016-03-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="一个根据log同步文件的脚本"><a href="#一个根据log同步文件的脚本" class="headerlink" title="一个根据log同步文件的脚本"></a>一个根据log同步文件的脚本</h1><h3 id="实现增量同步"><a href="#实现增量同步" class="headerlink" title="实现增量同步"></a>实现增量同步</h3><h3 id="后台运行"><a href="#后台运行" class="headerlink" title="后台运行"></a>后台运行</h3><p><img src="/upload/image/sync.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">RSYNC_LOCK&#x3D;&#39;&#x2F;home&#x2F;sh&#x2F;pro.lock&#39;</span><br><span class="line">rm -f $&#123;RSYNC_LOCK&#125;</span><br><span class="line"></span><br><span class="line">first_time&#x3D;true</span><br><span class="line">while [ 1 ]</span><br><span class="line">do</span><br><span class="line">echo &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;</span><br><span class="line">da&#x3D;&#96;date &quot;+%y&#x2F;%m&#x2F;%d %H:%M:%S&quot;&#96;</span><br><span class="line">echo $da</span><br><span class="line"></span><br><span class="line">if [ -e $&#123;RSYNC_LOCK&#125; ]; then</span><br><span class="line">    sleep 5</span><br><span class="line">   continue</span><br><span class="line">fi</span><br><span class="line">    touch $&#123;RSYNC_LOCK&#125;</span><br><span class="line">    echo &quot;first_time: &quot;$&#123;first_time&#125;</span><br><span class="line"></span><br><span class="line">## fisrt run</span><br><span class="line">    if [ $&#123;first_time&#125; &#x3D;&#x3D; true ];then</span><br><span class="line">        init_php_line&#x3D;1</span><br><span class="line">        init_ftp_line&#x3D;1</span><br><span class="line">    else</span><br><span class="line">        init_php_line&#x3D;$php_last_line</span><br><span class="line">        init_ftp_line&#x3D;$ftp_last_line</span><br><span class="line">    fi</span><br><span class="line">### log rotated </span><br><span class="line"></span><br><span class="line">    rotate_time&#x3D;&#96;echo &quot;$da&quot;|awk &#39;&#123;print $2&#125;&#39;|awk -F&#39;:&#39; &#39;&#123;print $1$2&#125;&#39;&#96;</span><br><span class="line">    echo $&#123;rotate_time&#125;</span><br><span class="line">    if [[ $&#123;rotate_time&#125; &#x3D;~ 0002 ]];then</span><br><span class="line">        init_php_line&#x3D;1</span><br><span class="line">        init_ftp_line&#x3D;1</span><br><span class="line">    fi </span><br><span class="line">    echo &quot;php init line number &#x3D; &quot;$init_php_line</span><br><span class="line">    echo &quot;ftp init line number &#x3D; &quot;$init_ftp_line </span><br><span class="line">        </span><br><span class="line">    phplog&#x3D;&#39;&#x2F;var&#x2F;log&#x2F;php_upload.log&#39;</span><br><span class="line">    php_last_line&#x3D;&#96;wc -l $phplog|awk &#39;&#123;print $1&#125;&#39;&#96;</span><br><span class="line">    echo &quot;php_last_line: $&#123;php_last_line&#125;&quot;</span><br><span class="line">    if [[ $init_php_line -eq $php_last_line ]];then</span><br><span class="line">        echo &quot;-------- no new php log&quot;</span><br><span class="line">        has_new&#x3D;false</span><br><span class="line">    else </span><br><span class="line">        php_content&#x3D;&#96;sed -n &quot;$init_php_line,$ p&quot; $phplog&#96;</span><br><span class="line">        ##echo &quot;php_content : $php_content&quot;</span><br><span class="line">        if [[ -n $&#123;php_content&#125; ]];then</span><br><span class="line">            sed -n &quot;$init_php_line,$ p&quot; $phplog| awk &#39;&#123;print $9&#125;&#39;|sed &#39;s&#x2F;^\&#x2F;home1&#x2F;\.&#x2F;g&#39; &gt; &#x2F;home&#x2F;sh&#x2F;pro.file</span><br><span class="line">            has_new&#x3D;true</span><br><span class="line">        ## log rotating</span><br><span class="line">        else </span><br><span class="line">            has_new&#x3D;false</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line">    </span><br><span class="line">    echo &quot;----------&quot;</span><br><span class="line">    ftplog&#x3D;&#39;&#x2F;var&#x2F;log&#x2F;xferlog&#39;</span><br><span class="line">    ftp_last_line&#x3D;&#96;wc -l $ftplog|awk &#39;&#123;print $1&#125;&#39;&#96;</span><br><span class="line">    echo &quot;ftp_last_line: $&#123;ftp_last_line&#125;&quot;</span><br><span class="line">    if [[ $init_ftp_line -eq $ftp_last_line ]];then</span><br><span class="line">        echo &quot;------- no new ftp log&quot;</span><br><span class="line">    else</span><br><span class="line">        ftp_content&#x3D;&#96;sed -n &quot;$init_ftp_line,$ p&quot; $ftplog&#96;</span><br><span class="line">        ##echo &quot;ftp_content :  $ftp_content&quot;</span><br><span class="line">        if [[ -n $ftp_content ]];then </span><br><span class="line">            if [[ $has_new &#x3D;&#x3D; true ]];then</span><br><span class="line">                echo &quot;phplog has new: $has_new&quot;</span><br><span class="line">                sed -n &quot;$init_ftp_line,$ p&quot; $ftplog |awk &#39;&#123;print $9&#125;&#39;|sed -e &#39;s&#x2F;^\&#x2F;home1&#x2F;\.&#x2F;g&#39; -e &#39;s&#x2F;^\&#x2F;data\&#x2F;home1&#x2F;\.&#x2F;g&#39; &gt;&gt; &#x2F;home&#x2F;sh&#x2F;pro.file</span><br><span class="line">            else</span><br><span class="line">                echo &quot;phplog has new: $has_new&quot;</span><br><span class="line">                sed -n &quot;$init_ftp_line,$ p&quot; $ftplog |awk &#39;&#123;print $9&#125;&#39;|sed -e &#39;s&#x2F;^\&#x2F;home1&#x2F;\.&#x2F;g&#39; -e &#39;s&#x2F;^\&#x2F;data\&#x2F;home1&#x2F;\.&#x2F;g&#39; &gt; &#x2F;home&#x2F;sh&#x2F;pro.file</span><br><span class="line">            fi</span><br><span class="line">        fi</span><br><span class="line">    fi</span><br><span class="line"></span><br><span class="line">    first_time&#x3D;false</span><br><span class="line"></span><br><span class="line">    if [ -s &#x2F;home&#x2F;sh&#x2F;pro.file ];then</span><br><span class="line">        &#x2F;usr&#x2F;bin&#x2F;rsync -au --timeout&#x3D;30 --ignore-errors --files-from&#x3D;&#x2F;home&#x2F;sh&#x2F;pro.file &#x2F;home1&#x2F; 1.1.1.1::pic&#x2F; </span><br><span class="line">        cat &#x2F;dev&#x2F;null &gt; &#x2F;home&#x2F;sh&#x2F;pro.file</span><br><span class="line">    fi</span><br><span class="line">    rm -f $&#123;RSYNC_LOCK&#125;</span><br><span class="line">    sleep 5;</span><br><span class="line">done</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/01/openresty-ip-limit-times/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/02/01/openresty-ip-limit-times/" class="post-title-link" itemprop="url">openresty ip limit times</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-02-01 20:15:27" itemprop="dateCreated datePublished" datetime="2016-02-01T20:15:27+08:00">2016-02-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/openresty/" itemprop="url" rel="index"><span itemprop="name">openresty</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="openresty-restrict-ip-access-times"><a href="#openresty-restrict-ip-access-times" class="headerlink" title="openresty restrict ip access times"></a>openresty restrict ip access times</h1><ul>
<li>简单写了些基本的结构</li>
<li>先把每个ip的访问次数放在一个内存中,</li>
<li>每个ip的访问限制次数</li>
<li>达到一定的阈值, 进行控制</li>
<li>后面也写了一些admin的操作<ul>
<li>解除某个ip的限制</li>
<li>得到某个ip的已经记录的访问次数</li>
<li>清空所有的ip限制</li>
<li>得到部分ip次数(高版本openresty可以实现)</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">	listen 8080;</span><br><span class="line">	server_name wmr.com;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	error_log logs&#x2F;wmr-error.log debug;</span><br><span class="line">	location &#x2F; &#123;</span><br><span class="line">	access_by_lua &#39;</span><br><span class="line">-- local ip &#x3D; ngx.var.binary_remote_addr</span><br><span class="line">ip &#x3D; ngx.var.remote_addr</span><br><span class="line">limit &#x3D; ngx.shared.limit</span><br><span class="line">req,flag &#x3D; limit:get(ip)</span><br><span class="line">if req then</span><br><span class="line">    if req &lt; 10 then</span><br><span class="line">	limit:incr(ip,1)</span><br><span class="line">	return  ngx.exec(&quot;&#x2F;ok&quot;)</span><br><span class="line">    elseif req &gt;&#x3D; 10 and  req &lt; 15 then </span><br><span class="line">        limit:incr(ip,1)</span><br><span class="line">	return 	ngx.exec(&quot;&#x2F;limit&quot;)</span><br><span class="line">    else </span><br><span class="line">        ngx.exit(ngx.HTTP_SERVICE_UNAVAILABLE)</span><br><span class="line">    end</span><br><span class="line">else</span><br><span class="line">    limit:set(ip,1,60)</span><br><span class="line">end</span><br><span class="line">	&#39;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	location ~ ^&#x2F;limit &#123;</span><br><span class="line">	internal;</span><br><span class="line">	content_by_lua &#39;</span><br><span class="line">		ngx.say(&quot;ip will limited if visit more frequent&quot;);</span><br><span class="line">	&#39;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	location ~ ^&#x2F;ok &#123;</span><br><span class="line">	internal;</span><br><span class="line">	content_by_lua &#39;</span><br><span class="line">		ngx.say(&quot;access ok&quot;);</span><br><span class="line">	&#39;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##curl -i  &quot;wmr.com&#x2F;delete?ip&#x3D;127.0.0.1&quot;  -x 127.0.0.1:8080</span><br><span class="line">	location ~ ^&#x2F;delete &#123;</span><br><span class="line">	allow 127.0.0.1;</span><br><span class="line">	deny all;</span><br><span class="line">content_by_lua &#39;</span><br><span class="line">	local limit &#x3D; ngx.shared.limit</span><br><span class="line">	local args &#x3D; ngx.req.get_uri_args()</span><br><span class="line">	for  key,val  in  pairs(args)</span><br><span class="line">	do</span><br><span class="line">		if key &#x3D;&#x3D; &quot;ip&quot; then</span><br><span class="line">			target_ip &#x3D; val</span><br><span class="line">		end</span><br><span class="line">		if target_ip &#x3D;&#x3D; nil then</span><br><span class="line">			ngx.say(&quot;no input key &quot;)</span><br><span class="line">		end</span><br><span class="line"></span><br><span class="line">		if target_ip ~&#x3D; &quot;&quot;  then</span><br><span class="line">			ngx.say(target_ip)</span><br><span class="line">		 	limit:set(target_ip, nil)</span><br><span class="line">			os.execute(&quot;sleep 0.5&quot;)</span><br><span class="line">			limit:get(target_ip)</span><br><span class="line">			ngx.exit(ngx.HTTP_OK)</span><br><span class="line">		else</span><br><span class="line">			ngx.say(&quot;key error&quot;)</span><br><span class="line">		end</span><br><span class="line"></span><br><span class="line">		-- if type(val) &#x3D;&#x3D; &quot;table&quot;  then </span><br><span class="line">		--	ngx.say(key,&quot;:&quot;,table.concat(val,&quot;,&quot;))</span><br><span class="line">		-- else</span><br><span class="line">		-- 	ngx.say(key,&quot;:&quot;,val)</span><br><span class="line">		-- end</span><br><span class="line">	end</span><br><span class="line"></span><br><span class="line">	&#39;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">##curl -i  &quot;wmr.com&#x2F;get?ip&#x3D;127.0.0.1&quot;  -x 127.0.0.1:8080</span><br><span class="line">	location ~ ^&#x2F;get &#123;</span><br><span class="line">	allow 127.0.0.1;</span><br><span class="line">	deny all;</span><br><span class="line">	access_by_lua &#39;</span><br><span class="line">		local limit &#x3D; ngx.shared.limit</span><br><span class="line">		local args &#x3D; ngx.req.get_uri_args()</span><br><span class="line">		for  key,val  in  pairs(args)</span><br><span class="line">		do</span><br><span class="line">			if key &#x3D;&#x3D; &quot;ip&quot; then</span><br><span class="line">				target_ip &#x3D; val</span><br><span class="line">				ngx.say(target_ip)</span><br><span class="line">				local req,flag &#x3D; limit:get(target_ip)</span><br><span class="line">				ngx.say(req)</span><br><span class="line">				ngx.exit(ngx.HTTP_OK)</span><br><span class="line">			end</span><br><span class="line">		end</span><br><span class="line">	&#39;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">##curl -i wmr.com&#x2F;flushall -x 127.0.0.1:8080</span><br><span class="line">	location ~ ^&#x2F;flushall$ &#123;</span><br><span class="line">	access_by_lua &#39;</span><br><span class="line">		local limit &#x3D; ngx.shared.limit</span><br><span class="line">		limit:flush_all()</span><br><span class="line">		ngx.say(&quot;flush all ip&quot;)</span><br><span class="line">		ngx.exit(ngx.HTTP_OK)</span><br><span class="line">	&#39;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">##early version not support </span><br><span class="line">	location ~ ^&#x2F;getall$ &#123;</span><br><span class="line">	access_by_lua &#39;</span><br><span class="line">		local limit &#x3D; ngx.shared.limit</span><br><span class="line">		limit:get_keys(5)</span><br><span class="line">		ngx.exit(ngx.HTTP_OK)</span><br><span class="line">	&#39;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/01/python-log-analyze/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/02/01/python-log-analyze/" class="post-title-link" itemprop="url">python log analyze</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-02-01 20:05:48" itemprop="dateCreated datePublished" datetime="2016-02-01T20:05:48+08:00">2016-02-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/python-log/" itemprop="url" rel="index"><span itemprop="name">python log</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="nginx-log-url统计"><a href="#nginx-log-url统计" class="headerlink" title="nginx log url统计"></a>nginx log url统计</h1><ul>
<li>python tailf 每条nginx的log, 把url存放在redis,设置过期时间,后台运行</li>
<li>每条key ,放在一个redis的list中, 保证list中每个item是唯一的</li>
<li>设置这个list的过期时间是一天</li>
<li>每分钟从这个list中遍历元素,即是redis的set,每次取set的value放在python的dict中</li>
<li>遍历python的dict,然后print 访问量前n的数据</li>
</ul>
<p>set key的代码<br>python insert_redis.py &gt; /dev/null 2&gt;&amp;1  &amp; </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;python</span><br><span class="line"></span><br><span class="line">import sys,os</span><br><span class="line">import redis</span><br><span class="line">import time</span><br><span class="line">import subprocess</span><br><span class="line">import select</span><br><span class="line"></span><br><span class="line">r &#x3D; redis.Redis(host&#x3D;&#39;localhost&#39;,port&#x3D;6379,db&#x3D;0)</span><br><span class="line"></span><br><span class="line">def insert_redis(insert_key,expire):</span><br><span class="line">    url_list &#x3D; r.lrange(&#39;url&#39;,0,-1)</span><br><span class="line">    #print url_list</span><br><span class="line">    k &#x3D; &#39;URL_&#39; + str(insert_key)</span><br><span class="line">    k &#x3D; k.strip(&#39;\n&#39;)</span><br><span class="line">    if k in url_list:</span><br><span class="line">        print &quot;&#123;0&#125; in &quot;.format(k)</span><br><span class="line">        r.incr(k)</span><br><span class="line">    else:</span><br><span class="line">        print &quot;&#123;0&#125; not in&quot;.format(k)</span><br><span class="line">        r.setex(k,1,expire)</span><br><span class="line">        r.lpush(&#39;url&#39;,k)</span><br><span class="line">    times &#x3D; r.get(k)</span><br><span class="line"></span><br><span class="line">    print &quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line">filename &#x3D; &#39;&#x2F;home&#x2F;nginx&#x2F;logs&#x2F;access.log&#39;</span><br><span class="line">f &#x3D; subprocess.Popen([&#39;tail&#39;,&#39;-F&#39;,filename],\</span><br><span class="line">        stdout&#x3D;subprocess.PIPE,stderr&#x3D;subprocess.PIPE)</span><br><span class="line">p &#x3D; select.poll()</span><br><span class="line">p.register(f.stdout)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    if p.poll(1):</span><br><span class="line">        line &#x3D; f.stdout.readline()</span><br><span class="line">	insert_key &#x3D; line.split()[6]</span><br><span class="line">	print insert_key</span><br><span class="line">	insert_redis(insert_key,86400)</span><br><span class="line">    time.sleep(0.2)</span><br></pre></td></tr></table></figure>


<p>get key的代码<br>python pyredis.py</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#!&#x2F;usr&#x2F;bin&#x2F;python</span><br><span class="line">import sys,os</span><br><span class="line">import redis</span><br><span class="line"></span><br><span class="line">#print r.get(&#39;URL:nc.apk&#39;)</span><br><span class="line">#r.lrange(&#39;url&#39;,0,3) return times </span><br><span class="line">#print r.lrange(&#39;abc&#39;,0,-1)</span><br><span class="line">## if not exist touch &#39;abc</span><br><span class="line"></span><br><span class="line">def get_redis():</span><br><span class="line">    url_list &#x3D; r.lrange(&#39;url&#39;,0,-1)</span><br><span class="line">    print url_list</span><br><span class="line">    for k in url_list:</span><br><span class="line">    	times &#x3D; r.get(k)</span><br><span class="line">    	print times</span><br><span class="line">        if times &#x3D;&#x3D; None:</span><br><span class="line">            continue</span><br><span class="line">        else:</span><br><span class="line">    	    url_dict[k] &#x3D; int(times)</span><br><span class="line">def set_expire():</span><br><span class="line">    import datetime </span><br><span class="line">    date &#x3D; datetime.datetime.now()</span><br><span class="line">    hm&#x3D; date.strftime(&quot;%H:%M&quot;)</span><br><span class="line">    print hm</span><br><span class="line">    if hm &#x3D;&#x3D; &#39;00:00&#39;:</span><br><span class="line">        r.expire(&#39;url&#39;,86400)</span><br><span class="line"></span><br><span class="line">def sort_by_key_top(n):</span><br><span class="line">    top &#x3D; 1</span><br><span class="line">    for key,value in sorted(url_dict.iteritems(), key&#x3D;lambda d:d[1], reverse &#x3D; True):</span><br><span class="line">        url_dict.setdefault(key,0)</span><br><span class="line">        if top &#x3D;&#x3D; n :</span><br><span class="line">    	    print key + &quot;&#x3D;&quot; + str(value) + &#39;,&#39;,</span><br><span class="line">            break</span><br><span class="line">         </span><br><span class="line">        print key + &quot;&#x3D;&quot; + str(value) + &#39;,&#39;,</span><br><span class="line">        top +&#x3D; 1</span><br><span class="line"></span><br><span class="line">if __name__ &#x3D;&#x3D; &#39;__main__&#39;:</span><br><span class="line">    r &#x3D; redis.Redis(host&#x3D;&#39;localhost&#39;,port&#x3D;6379,db&#x3D;0)</span><br><span class="line">    url_dict &#x3D; &#123;&#125;</span><br><span class="line">    get_redis()</span><br><span class="line">    sort_by_key_top(10)</span><br><span class="line">    set_expire()</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/14/http-code-monitor/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/01/14/http-code-monitor/" class="post-title-link" itemprop="url">http code monitor</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-01-14 18:35:42" itemprop="dateCreated datePublished" datetime="2016-01-14T18:35:42+08:00">2016-01-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/bash/" itemprop="url" rel="index"><span itemprop="name">bash</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="一个bash-脚本"><a href="#一个bash-脚本" class="headerlink" title="一个bash 脚本."></a>一个bash 脚本.</h2><ul>
<li>计算qps</li>
<li>用户请求的状态码</li>
<li>upstream状态码,</li>
<li>2xx/3xx的比率</li>
<li>需要注意的问题 写在脚本的注释了.</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">if [ $# -eq 2 ]; then</span><br><span class="line">	log&#x3D;$1</span><br><span class="line">	oldlog&#x3D;$2</span><br><span class="line">else </span><br><span class="line">	log&#x3D;&quot;&#x2F;home&#x2F;nginx&#x2F;logs&#x2F;xxxxx-access.log&quot;</span><br><span class="line">	ye&#x3D;&#96;date -d &#39;1 day ago&#39; +%Y%m%d&#96;</span><br><span class="line">	oldlog&#x3D;&quot;&#x2F;home&#x2F;nginx&#x2F;logs&#x2F;backup&#x2F;xxxx-access.log-$ye&quot;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">d&#x3D;&#96;date -d &#39;1 min ago&#39; +%d&#x2F;%b&#x2F;%Y:%H:%M&#96;</span><br><span class="line">#for test</span><br><span class="line">#d&#x3D;&quot;14&#x2F;Jan&#x2F;2016:00:05&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if [ &#96;head -1 $log|grep -c &quot;$d&quot;&#96; -eq 1 ];then</span><br><span class="line">	## log rotate的特殊分钟考虑.</span><br><span class="line">	if [ -f $oldlog ];then</span><br><span class="line">		tail -50000 $oldlog &gt; &#x2F;tmp&#x2F;3g.log</span><br><span class="line">		head -50000 $log &gt;&gt; &#x2F;tmp&#x2F;3g.log	</span><br><span class="line">        ##放在一个文件里，因为放在一个变量里var&#x3D;&#96;cat file&#96; , var里面没法按行去读</span><br><span class="line">	else </span><br><span class="line">		head -50000 $log &gt; &#x2F;tmp&#x2F;3g.log	</span><br><span class="line">	fi</span><br><span class="line">    ## 主要涉及</span><br><span class="line">    (1)shell 变量传给awk</span><br><span class="line">    (2)awk 正则匹配普通数值或字符串&#x2F;&#x2F;, 匹配变量</span><br><span class="line">    (3)log中特殊字段的值重置, 比如log的最后一个字段 upstream_cache_status, 可能为&quot;-&quot;, 这个数据放在awk里面的数组当做key会报错, 所以把它替换成999, 另外注意不要在END阶段去替换,在key被存入数组之前替换</span><br><span class="line">    (4)log中 NF字段有可能是200&quot;  这样的, 左边少个&quot;, 在直接执行eval后面的内容是没有问题,但是和eval一起执行的时候,bash报错,提示少&quot;, 所以用正则把^[0-9]开头的替换为000; 保证bash不报错.</span><br><span class="line">    (5) awk变量传给shell, 用eval</span><br><span class="line">    (6) awk if else if else语法;</span><br><span class="line">    (7) awk 数组赋值及取值.</span><br><span class="line">	eval $(tail -100000 &#x2F;tmp&#x2F;3g.log|awk -v date&#x3D;&quot;$d&quot; &#39;$4 ~ date&#123;count+&#x3D;1;status[$9]+&#x3D;1; if($NF ~ &#x2F;^[0-9]&#x2F;) u&#x3D;&quot;000&quot; ; else if($NF ~ &#x2F;-&#x2F;) u&#x3D;&quot;999&quot; ;else u&#x3D;$NF; upstatus[u]+&#x3D;1&#125;END&#123;printf(&quot;count&#x3D;%d\n&quot;, count);for (i in status)&#123;printf(&quot;code[%s]&#x3D;%s\n;&quot;,i,status[i]);&#125; ; for (j in upstatus)&#123;printf(&quot;upcode[%s]&#x3D;%s\n;&quot;,j,upstatus[j])&#125;&#125;&#39;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">else </span><br><span class="line">	## fix a bug </span><br><span class="line">	</span><br><span class="line">	eval $(tail -100000 &#x2F;home&#x2F;nginx&#x2F;logs&#x2F;xxxx.log|awk -v date&#x3D;&quot;$d&quot; &#39;$4 ~ date&#123;count+&#x3D;1;status[$9]+&#x3D;1; if($NF ~ &#x2F;^[0-9]&#x2F;) u&#x3D;&quot;000&quot; ; else if($NF ~ &#x2F;-&#x2F;) u&#x3D;&quot;999&quot; ;else u&#x3D;$NF; upstatus[u]+&#x3D;1&#125;END&#123;printf(&quot;count&#x3D;%d\n&quot;, count);for (i in status)&#123;printf(&quot;code[%s]&#x3D;%s\n;&quot;,i,status[i]);&#125; ; for (j in upstatus)&#123;printf(&quot;upcode[%s]&#x3D;%s\n;&quot;,j,upstatus[j])&#125;&#125;&#39;)</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">## 计算qps</span><br><span class="line">echo &quot;&#x3D;&#x3D;wap_qps&quot;</span><br><span class="line">qps&#x3D;$(($count&#x2F;60))</span><br><span class="line">echo &quot;qps&#x3D;$qps,&quot;</span><br><span class="line"></span><br><span class="line">bad&#x3D;0</span><br><span class="line">baduc&#x3D;0</span><br><span class="line">echo &quot;&#x3D;&#x3D;wap_status&quot;</span><br><span class="line"></span><br><span class="line">##遍历关联数组</span><br><span class="line">for c in $&#123;!code[*]&#125; ;do</span><br><span class="line">	echo -n &quot;code$c&#x3D;$&#123;code[$c]&#125;,&quot;</span><br><span class="line">	if [[ $c &#x3D;~ &#39;50&#39; ]] || [[ $c &#x3D;~ &#39;40&#39; ]];then  ##判断5xx 4xx的数量</span><br><span class="line">		bad&#x3D;$(($bad + $&#123;code[$c]&#125;))</span><br><span class="line">	fi	</span><br><span class="line">done</span><br><span class="line">ok&#x3D;$(($count - $bad))</span><br><span class="line">ratio&#x3D;$(echo &quot;scale&#x3D;5; $ok*100&#x2F;$count&quot;|bc)  ##计算比率 ,bash $(()) 得不到小数, 注意用bc来计算得到小数,并且可以设置小数的位数</span><br><span class="line">echo </span><br><span class="line">echo &quot;&#x3D;&#x3D;ratio&quot;</span><br><span class="line">echo  &quot;ratio&#x3D;$ratio&quot;</span><br><span class="line"></span><br><span class="line">echo &quot;&#x3D;&#x3D;wap_up_status&quot;</span><br><span class="line">for uc in $&#123;!upcode[*]&#125; ;do </span><br><span class="line">	echo -n &quot;upcode$uc&#x3D;$&#123;upcode[$uc]&#125;,&quot;</span><br><span class="line">	if [[ $uc &#x3D;~ &#39;50&#39; ]]  ||  [[ $uc &#x3D;~ &#39;40&#39; ]];then</span><br><span class="line">		baduc&#x3D;$(($baduc + $&#123;upcode[$uc]&#125;))</span><br><span class="line">	fi</span><br><span class="line">done</span><br><span class="line">ok_uc&#x3D;$(($count - $baduc))</span><br><span class="line">ratio_uc&#x3D;$(echo &quot;scale&#x3D;5; $&#123;ok_uc&#125;*100&#x2F;$count&quot;|bc )</span><br><span class="line">echo </span><br><span class="line">echo &quot;&#x3D;&#x3D;ratio_uc&quot;</span><br><span class="line">echo &quot;ratio_uc&#x3D;$&#123;ratio_uc&#125;&quot;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/14/another-qps/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/01/14/another-qps/" class="post-title-link" itemprop="url">another qps</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-01-14 11:01:33" itemprop="dateCreated datePublished" datetime="2016-01-14T11:01:33+08:00">2016-01-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/shell/" itemprop="url" rel="index"><span itemprop="name">shell</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="另外一个计算qps的脚本"><a href="#另外一个计算qps的脚本" class="headerlink" title="另外一个计算qps的脚本"></a>另外一个计算qps的脚本</h2><ul>
<li>nginx log在同一个目录里面</li>
<li>每个host的log是单独的文件</li>
<li>oldlog是用logrotate做的,delay compress</li>
</ul>
<h3 id="ws"><a href="#ws" class="headerlink" title="ws."></a>ws.</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">loglist&#x3D;($(find &#x2F;var&#x2F;log&#x2F;nginx&#x2F; -regextype &quot;posix-egrep&quot; -regex &quot;.*-access.log&quot;))</span><br><span class="line">d&#x3D;&#96;date -d &#39;1 min ago&#39; +%d&#x2F;%b&#x2F;%Y:%H:%M&#96;</span><br><span class="line">#for test</span><br><span class="line">#d&#x3D;&quot;2016:06:25&quot;</span><br><span class="line"></span><br><span class="line">sum&#x3D;0</span><br><span class="line">for log in $&#123;loglist[*]&#125; ; do</span><br><span class="line">	if [ &#96;head -1 $log|grep -c &quot;$d&quot;&#96; -eq 1 ];then </span><br><span class="line">		oldlog&#x3D;$&#123;log&#125;&quot;.1&quot;</span><br><span class="line">		if [ -f $oldlog ];then</span><br><span class="line">			count_old&#x3D;&#96;tail -5000 $oldlog|grep -c &quot;$d&quot;&#96;</span><br><span class="line">		else</span><br><span class="line">			count_old&#x3D;0</span><br><span class="line">		fi</span><br><span class="line">		count_new&#x3D;&#96;head -5000 $log|grep -c &quot;$d&quot;&#96;</span><br><span class="line">		count&#x3D;$(($count_old +$count_new))</span><br><span class="line">	else </span><br><span class="line">		count&#x3D;&#96;tail -10000 $log|grep -c &quot;$d&quot;&#96;</span><br><span class="line">	fi</span><br><span class="line">	</span><br><span class="line">	sum&#x3D;$(($sum + $count))</span><br><span class="line">done</span><br><span class="line">qps&#x3D;$(($sum &#x2F; 60))</span><br><span class="line"></span><br><span class="line">echo &quot;&#x3D;&#x3D;ws_qps&quot;</span><br><span class="line">echo &quot;ws_qps&#x3D;$qps&quot;</span><br></pre></td></tr></table></figure>

<h3 id="another-wap"><a href="#another-wap" class="headerlink" title="another wap"></a>another wap</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">loglist&#x3D;($(find &#x2F;home&#x2F;nginx&#x2F;logs&#x2F; -type f -name &quot;*-access.log&quot;))</span><br><span class="line">d&#x3D;&#96;date -d &#39;1 min ago&#39; +%d&#x2F;%b&#x2F;%Y:%H:%M&#96;</span><br><span class="line">#for test</span><br><span class="line">#d&#x3D;&quot;14&#x2F;Jan&#x2F;2016:00:05&quot;</span><br><span class="line"></span><br><span class="line">sum&#x3D;0</span><br><span class="line">for log in $&#123;loglist[*]&#125; ; do</span><br><span class="line">        if [ &#96;head -1 $log|grep -c &quot;$d&quot;&#96; -eq 1 ];then</span><br><span class="line">                suffix&#x3D;&#96;echo -n $log|awk -F &#39;&#x2F;&#39; &#39;&#123;print $NF&#125;&#39;&#96;</span><br><span class="line">                ye&#x3D;&#96;date -d &#39;1 day ago&#39; +%Y%m%d&#96;</span><br><span class="line">                oldlog&#x3D;&quot;&#x2F;home&#x2F;nginx&#x2F;logs&#x2F;backup&#x2F;&quot;&quot;$&#123;suffix&#125;-$&#123;ye&#125;&quot;</span><br><span class="line">                if [ -f $oldlog ];then</span><br><span class="line">                        count_old&#x3D;&#96;tail -50000 $oldlog|grep -c &quot;$d&quot;&#96;</span><br><span class="line">                else</span><br><span class="line">                        count_old&#x3D;0</span><br><span class="line">                fi</span><br><span class="line">                count_new&#x3D;&#96;head -50000 $log|grep -c &quot;$d&quot;&#96;</span><br><span class="line">                count&#x3D;$(($count_old +$count_new))</span><br><span class="line">        else</span><br><span class="line">                count&#x3D;&#96;tail -100000 $log|grep -c &quot;$d&quot;&#96;</span><br><span class="line">        fi</span><br><span class="line"></span><br><span class="line">        sum&#x3D;$(($sum + $count))</span><br><span class="line">done</span><br><span class="line">qps&#x3D;$(($sum &#x2F; 60))</span><br><span class="line"></span><br><span class="line">echo &quot;&#x3D;&#x3D;wap_qps&quot;</span><br><span class="line">echo &quot;wap_qps&#x3D;$qps&quot;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/01/13/qps-calculation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2016/01/13/qps-calculation/" class="post-title-link" itemprop="url">qps calculation</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2016-01-13 17:58:44" itemprop="dateCreated datePublished" datetime="2016-01-13T17:58:44+08:00">2016-01-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="分享一个计算qps的脚本"><a href="#分享一个计算qps的脚本" class="headerlink" title="分享一个计算qps的脚本"></a>分享一个计算qps的脚本</h1><h2 id="主要思路就是根据nginx-log-来定时取一分钟的log数目"><a href="#主要思路就是根据nginx-log-来定时取一分钟的log数目" class="headerlink" title="主要思路就是根据nginx log 来定时取一分钟的log数目."></a>主要思路就是根据nginx log 来定时取一分钟的log数目.</h2><h2 id="需要注意的是"><a href="#需要注意的是" class="headerlink" title="需要注意的是:"></a>需要注意的是:</h2><ul>
<li>日志切割的时间点qos,要加上切割之前的log的那分钟的数据,否则是不完整的</li>
<li>由于考虑到对机器的压力,每分钟跑一次然后除60得到qps</li>
<li>具体如下</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line"></span><br><span class="line">if [ $# -eq 2 ];then</span><br><span class="line">    LOG&#x3D;$1</span><br><span class="line">    OLDLOG&#x3D;$2</span><br><span class="line">else</span><br><span class="line">    LOG&#x3D;&quot;&#x2F;home&#x2F;nginx&#x2F;logs&#x2F;access.log&quot;</span><br><span class="line">    OLDLOG&#x3D;&#39;&#x2F;home&#x2F;nginx&#x2F;logs&#x2F;backup&#x2F;access.log.1&#39;</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if [ ! -f $LOG ];then</span><br><span class="line">    echo &quot;log file not exist&quot;</span><br><span class="line">    exit 1</span><br><span class="line">else</span><br><span class="line">   d&#x3D;&#96;date -d &#39;1 min ago&#39; +%Y:%H:%M&#96;</span><br><span class="line">   #for test</span><br><span class="line">   #d&#x3D;&quot;2016:17:05&quot;</span><br><span class="line">   if [ &#96;head -1 $LOG|grep -c &quot;$d&quot;&#96; -ge 1 ];then</span><br><span class="line">        if [ -f $OLDLOG ];then</span><br><span class="line">            old_count&#x3D;&#96;grep -c &quot;$d&quot; $OLDLOG&#96;</span><br><span class="line">        else</span><br><span class="line">            old_count&#x3D;0</span><br><span class="line">        fi</span><br><span class="line">        new_count&#x3D;&#96;grep -c &quot;$d&quot; $LOG&#96;</span><br><span class="line">        count&#x3D;$(($new_count + $old_count))</span><br><span class="line">    else</span><br><span class="line">        count&#x3D;&#96;grep -c &quot;$d&quot; $LOG&#96;</span><br><span class="line">    fi</span><br><span class="line">fi</span><br><span class="line">qps&#x3D;$(($count &#x2F; 60))</span><br><span class="line"></span><br><span class="line">echo &quot;&#x3D;&#x3D;qps&quot;</span><br><span class="line">echo &quot;qps&#x3D;$qps&quot;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/12/30/my-vimrc-config/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/30/my-vimrc-config/" class="post-title-link" itemprop="url">my vimrc config</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-30 19:26:51" itemprop="dateCreated datePublished" datetime="2015-12-30T19:26:51+08:00">2015-12-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="我的一份vimrc的配置-比较多"><a href="#我的一份vimrc的配置-比较多" class="headerlink" title="我的一份vimrc的配置(比较多)"></a>我的一份vimrc的配置(比较多)</h1><p>.vimrc        </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br></pre></td><td class="code"><pre><span class="line">set nocompatible              &quot; be iMproved, required</span><br><span class="line">filetype off                  &quot; required</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; Vundle 的配置</span><br><span class="line">&quot; set the runtime path to include Vundle and initialize</span><br><span class="line">set rtp+&#x3D;~&#x2F;.vim&#x2F;bundle&#x2F;Vundle.vim</span><br><span class="line">call vundle#begin()</span><br><span class="line">&quot; alternatively, pass a path where Vundle should install plugins</span><br><span class="line">&quot;call vundle#begin(&#39;~&#x2F;some&#x2F;path&#x2F;here&#39;)</span><br><span class="line"></span><br><span class="line">&quot; let Vundle manage Vundle, required</span><br><span class="line">Plugin &#39;gmarik&#x2F;Vundle.vim&#39;</span><br><span class="line"></span><br><span class="line">&quot; The following are examples of different formats supported.</span><br><span class="line">&quot; Keep Plugin commands between vundle#begin&#x2F;end.</span><br><span class="line">&quot; plugin on GitHub repo</span><br><span class="line">Plugin &#39;tpope&#x2F;vim-fugitive&#39;</span><br><span class="line">&quot; plugin from http:&#x2F;&#x2F;vim-scripts.org&#x2F;vim&#x2F;scripts.html</span><br><span class="line">Plugin &#39;L9&#39;</span><br><span class="line">&quot; Git plugin not hosted on GitHub</span><br><span class="line">Plugin &#39;git:&#x2F;&#x2F;git.wincent.com&#x2F;command-t.git&#39;</span><br><span class="line">&quot; git repos on your local machine (i.e. when working on your own plugin)</span><br><span class="line">&quot;Plugin &#39;file:&#x2F;&#x2F;&#x2F;home&#x2F;gmarik&#x2F;path&#x2F;to&#x2F;plugin&#39;</span><br><span class="line">&quot; The sparkup vim script is in a subdirectory of this repo called vim.</span><br><span class="line">&quot; Pass the path to set the runtimepath properly.</span><br><span class="line">Plugin &#39;rstacruz&#x2F;sparkup&#39;, &#123;&#39;rtp&#39;: &#39;vim&#x2F;&#39;&#125;</span><br><span class="line">&quot; Avoid a name conflict with L9</span><br><span class="line">&quot;Plugin &#39;user&#x2F;L9&#39;, &#123;&#39;name&#39;: &#39;newL9&#39;&#125;</span><br><span class="line"></span><br><span class="line">&quot; All of your Plugins must be added before the following line</span><br><span class="line">call vundle#end()            &quot; required</span><br><span class="line">filetype plugin indent on    &quot; required</span><br><span class="line">&quot; To ignore plugin indent changes, instead use:</span><br><span class="line">&quot;filetype plugin on</span><br><span class="line">&quot;</span><br><span class="line">&quot; Brief help</span><br><span class="line">&quot; :PluginList       - lists configured plugins</span><br><span class="line">&quot; :PluginInstall    - installs plugins; append &#96;!&#96; to update or just :PluginUpdate</span><br><span class="line">&quot; :PluginSearch foo - searches for foo; append &#96;!&#96; to refresh local cache</span><br><span class="line">&quot; :PluginClean      - confirms removal of unused plugins; append &#96;!&#96; to auto-approve removal</span><br><span class="line">&quot;</span><br><span class="line">&quot; see :h vundle for more details or wiki for FAQ</span><br><span class="line">&quot; Put your non-Plugin stuff after this line</span><br><span class="line">&quot; Vundle的配置 结束</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot; YCM, 自动补全</span><br><span class="line">Bundle &#39;Valloric&#x2F;YouCompleteMe&#39;</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; 文件模板头 ,可以设置作者</span><br><span class="line">&quot; install xptemplate</span><br><span class="line">Bundle &#39;drmingdrmer&#x2F;xptemplate&#39;</span><br><span class="line">let g:xptemplate_vars&#x3D;&quot;$author&#x3D;&quot;</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; NerdTree, 文件列表</span><br><span class="line">&quot; install Nerdtree</span><br><span class="line">Bundle &#39;scrooloose&#x2F;nerdtree&#39;</span><br><span class="line">&quot;autocmd VimEnter * NERDTree</span><br><span class="line">nmap &lt;F2&gt; :NERDTreeToggle &lt;CR&gt;</span><br><span class="line">&quot;let NERDTreeWinPos&#x3D;&quot;right&quot;</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; 语法检查</span><br><span class="line">Bundle &#39;scrooloose&#x2F;syntastic&#39;</span><br><span class="line">set statusline+&#x3D;%#warningmsg#</span><br><span class="line">set statusline+&#x3D;%&#123;SyntasticStatuslineFlag()&#125;</span><br><span class="line">set statusline+&#x3D;%*</span><br><span class="line"></span><br><span class="line">let g:syntastic_always_populate_loc_list &#x3D; 0</span><br><span class="line">let g:syntastic_auto_loc_list &#x3D; 0</span><br><span class="line">let g:syntastic_check_on_open &#x3D; 0</span><br><span class="line">let g:syntastic_check_on_wq &#x3D; 0</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; 关于查找的插件</span><br><span class="line">&quot; install kien&#x2F;ctrlp.vim to speedly find file</span><br><span class="line">Bundle &#39;kien&#x2F;ctrlp.vim&#39;</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot; install to duiqi</span><br><span class="line">Bundle &#39;godlygeek&#x2F;tabular&#39;</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot; 设置缩进的竖线</span><br><span class="line">Bundle &#39;Yggdroot&#x2F;indentLine&#39;</span><br><span class="line">let g:indentLine_color_term &#x3D; 239</span><br><span class="line">let g:indent_guides_guide_size&#x3D;5</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot; 多括号之类的不同颜色,好区分</span><br><span class="line">Bundle &#39;kien&#x2F;rainbow_parentheses.vim&#39;</span><br><span class="line">let g:rbpt_colorpairs &#x3D; [</span><br><span class="line">    \ [&#39;brown&#39;,       &#39;RoyalBlue3&#39;],</span><br><span class="line">    \ [&#39;Darkblue&#39;,    &#39;SeaGreen3&#39;],</span><br><span class="line">    \ [&#39;darkgray&#39;,    &#39;DarkOrchid3&#39;],</span><br><span class="line">    \ [&#39;darkgreen&#39;,   &#39;firebrick3&#39;],</span><br><span class="line">    \ [&#39;darkcyan&#39;,    &#39;RoyalBlue3&#39;],</span><br><span class="line">    \ [&#39;darkred&#39;,     &#39;SeaGreen3&#39;],</span><br><span class="line">    \ [&#39;darkmagenta&#39;, &#39;DarkOrchid3&#39;],</span><br><span class="line">    \ [&#39;brown&#39;,       &#39;firebrick3&#39;],</span><br><span class="line">    \ [&#39;gray&#39;,        &#39;RoyalBlue3&#39;],</span><br><span class="line">    \ [&#39;darkmagenta&#39;, &#39;DarkOrchid3&#39;],</span><br><span class="line">    \ [&#39;Darkblue&#39;,    &#39;firebrick3&#39;],</span><br><span class="line">    \ [&#39;darkgreen&#39;,   &#39;RoyalBlue3&#39;],</span><br><span class="line">    \ [&#39;darkcyan&#39;,    &#39;SeaGreen3&#39;],</span><br><span class="line">    \ [&#39;darkred&#39;,     &#39;DarkOrchid3&#39;],</span><br><span class="line">    \ [&#39;red&#39;,         &#39;firebrick3&#39;],</span><br><span class="line">    \ ]</span><br><span class="line"></span><br><span class="line">&quot; 不加入这行, 防止黑色括号出现, 很难识别</span><br><span class="line">&quot; \ [&#39;black&#39;,       &#39;SeaGreen3&#39;],</span><br><span class="line"></span><br><span class="line">let g:rbpt_max &#x3D; 16</span><br><span class="line">let g:rbpt_loadcmd_toggle &#x3D; 0</span><br><span class="line">au VimEnter * RainbowParenthesesToggle</span><br><span class="line">au Syntax * RainbowParenthesesLoadRound</span><br><span class="line">au Syntax * RainbowParenthesesLoadSquare</span><br><span class="line">au Syntax * RainbowParenthesesLoadBraces</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Bundle &#39;tpope&#x2F;vim-surround&#39;</span><br><span class="line">Bundle &#39;tpope&#x2F;vim-repeat&#39;</span><br><span class="line"></span><br><span class="line">Bundle &#39;terryma&#x2F;vim-expand-region&#39;</span><br><span class="line">vmap v &lt;Plug&gt;(expand_region_expand)</span><br><span class="line">vmap V &lt;Plug&gt;(expand_region_shrink)</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">Bundle &#39;scrooloose&#x2F;nerdcommenter&#39;</span><br><span class="line">&quot; 注释的时候自动加个空格, 强迫症必配</span><br><span class="line">let g:NERDSpaceDelims&#x3D;1</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; 自动补全单引号，双引号等</span><br><span class="line">Bundle &#39;Raimondi&#x2F;delimitMate&#39;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; for python docstring &quot;, 特别有用</span><br><span class="line">au FileType python let b:delimitMate_nesting_quotes &#x3D; [&#39;&quot;&#39;]</span><br><span class="line">&quot; 关闭某些类型文件的自动补全</span><br><span class="line">au FileType mail let b:delimitMate_autoclose &#x3D; 0</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; 多光标</span><br><span class="line">Bundle &#39;terryma&#x2F;vim-multiple-cursors&#39;</span><br><span class="line">let g:multi_cursor_use_default_mapping&#x3D;0</span><br><span class="line">&quot; Default mapping</span><br><span class="line">let g:multi_cursor_next_key&#x3D;&#39;&lt;C-m&gt;&#39;</span><br><span class="line">let g:multi_cursor_prev_key&#x3D;&#39;&lt;C-p&gt;&#39;</span><br><span class="line">let g:multi_cursor_skip_key&#x3D;&#39;&lt;C-x&gt;&#39;</span><br><span class="line">let g:multi_cursor_quit_key&#x3D;&#39;&lt;Esc&gt;&#39;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">Bundle &quot;mbriggs&#x2F;mark.vim&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot;  this is pre config </span><br><span class="line">set bg&#x3D;dark</span><br><span class="line">syntax on</span><br><span class="line">&quot; 设置python的缩进</span><br><span class="line">autocmd FileType python setlocal et sta sw&#x3D;4 sts&#x3D;4</span><br><span class="line">&quot;set autoindent</span><br><span class="line">&quot;set smartindent</span><br><span class="line">&quot;set expandtab</span><br><span class="line">&quot;set tabstop&#x3D;4</span><br><span class="line">&quot;set shiftwidth&#x3D;4</span><br><span class="line">&quot;set softtabstop&#x3D;4</span><br><span class="line">&quot;set noexpandtab</span><br><span class="line"></span><br><span class="line">&quot; install molokai</span><br><span class="line">&quot;let g:molokai_original &#x3D; 1</span><br><span class="line">&quot;let g:rehash256 &#x3D; 1</span><br><span class="line">&quot; set for molokai</span><br><span class="line">&quot; 设置molokai配色</span><br><span class="line">set t_Co&#x3D;256</span><br><span class="line">colorscheme molokai</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot;syntax enable</span><br><span class="line">&quot;set background&#x3D;dark</span><br><span class="line">&quot;colorscheme solarized</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; 设置每次打开文件,返回上次编辑的位置,比较有用.</span><br><span class="line">&quot; return to last cursor</span><br><span class="line">au BufReadPost * if line(&quot;&#39;\&quot;&quot;) &gt; 0|if line(&quot;&#39;\&quot;&quot;) &lt;&#x3D; line(&quot;$&quot;)|exe(&quot;norm &#39;\&quot;&quot;)|else|exe &quot;norm $&quot;|endif|endif</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot;&quot; set for powerline-vim no use</span><br><span class="line">&quot;set guifont&#x3D;MyFont\ for\ Powerline</span><br><span class="line">&quot;set nocompatible </span><br><span class="line">&quot;set t_Co&#x3D;256 </span><br><span class="line">&quot;let g:Powerline_symbols &#x3D; &#39;fancy&#39; </span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line">&quot; 设置powerline</span><br><span class="line">&quot; set for powerline</span><br><span class="line">set rtp+&#x3D;&#x2F;usr&#x2F;local&#x2F;lib&#x2F;python2.7&#x2F;dist-packages&#x2F;powerline&#x2F;bindings&#x2F;vim</span><br><span class="line"></span><br><span class="line">&quot;These lines setup the environment to show graphics and colors correctly.</span><br><span class="line">set nocompatible</span><br><span class="line">set t_Co&#x3D;256</span><br><span class="line"> </span><br><span class="line">let g:minBufExplForceSyntaxEnable &#x3D; 1</span><br><span class="line">python from powerline.vim import setup as powerline_setup</span><br><span class="line">python powerline_setup()</span><br><span class="line">python del powerline_setup</span><br><span class="line">  </span><br><span class="line">if ! has(&#39;gui_running&#39;)</span><br><span class="line">set ttimeoutlen&#x3D;10</span><br><span class="line">augroup FastEscape</span><br><span class="line">autocmd!</span><br><span class="line">      au InsertEnter * set timeoutlen&#x3D;0</span><br><span class="line">      au InsertLeave * set timeoutlen&#x3D;1000</span><br><span class="line">      augroup END</span><br><span class="line">endif</span><br><span class="line"></span><br><span class="line">set laststatus&#x3D;2 &quot; Always display the statusline in all windows</span><br><span class="line">set guifont&#x3D;Inconsolata\ for\ Powerline:h14</span><br><span class="line">set noshowmode &quot; Hide the default mode text (e.g. -- INSERT -- below the statusline</span><br><span class="line">&quot;&quot; set for powerline</span><br><span class="line">&quot; 结束设置powerline</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot; 设置黏贴的模式,防止黏贴格式混乱</span><br><span class="line">&quot; set for paste  mode</span><br><span class="line">nnoremap &lt;F3&gt; :set invpaste paste?&lt;CR&gt;</span><br><span class="line">imap &lt;F3&gt; &lt;C-O&gt;:set invpaste paste?&lt;CR&gt;</span><br><span class="line">set pastetoggle&#x3D;&lt;F3&gt;</span><br><span class="line"></span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">&quot;开启光亮光标行</span><br><span class="line">set cursorline</span><br><span class="line">&quot;hi CursorLine   cterm&#x3D;NONE ctermbg&#x3D;darkred ctermfg&#x3D;white guibg&#x3D;darkred guifg&#x3D;white</span><br><span class="line">&quot;hi CursorLine   ctermfg&#x3D;White ctermbg&#x3D;Yellow cterm&#x3D;bold guifg&#x3D;white guibg&#x3D;yellow gui&#x3D;bold</span><br><span class="line"></span><br><span class="line">&quot;开启高亮光标列</span><br><span class="line">set cursorcolumn</span><br><span class="line">&quot;hi CursorColumn cterm&#x3D;NONE ctermbg&#x3D;darkred ctermfg&#x3D;white guibg&#x3D;darkred guifg&#x3D;white </span><br><span class="line">&quot;hi CursorColumn ctermfg&#x3D;White ctermbg&#x3D;Yellow cterm&#x3D;bold guifg&#x3D;white guibg&#x3D;yellow gui&#x3D;bold</span><br><span class="line">&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/12/21/hexo-install-instruction/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/21/hexo-install-instruction/" class="post-title-link" itemprop="url">hexo install instruction</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-21 12:02:12" itemprop="dateCreated datePublished" datetime="2015-12-21T12:02:12+08:00">2015-12-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>hexo 搭建博客指引</p>
<h2 id="1-安装npm"><a href="#1-安装npm" class="headerlink" title="(1) 安装npm"></a>(1) 安装npm</h2><p>由于机器上之前的npm是Ubuntu12.04的源, 版本比较低,装起来会报错,解决方法(卸载npm,添加第三方的源,重新安装npm,nodejs)参考下面链接:</p>
<p>stackoverflow.com/questions/12913141/message-failed-to-fetch-from-registry-while-trying-to-install-any-module</p>
<p>注意npm要换源.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vim ~&#x2F;.npmrc   &#x2F;&#x2F;打开配置文件</span><br><span class="line">registry &#x3D;https:&#x2F;&#x2F;registry.npm.taobao.org   &#x2F;&#x2F;写入配置文件</span><br></pre></td></tr></table></figure>

<h2 id="2-安装-hexo-hexo-cli"><a href="#2-安装-hexo-hexo-cli" class="headerlink" title="(2)安装 hexo hexo-cli"></a>(2)安装 hexo hexo-cli</h2><p>参考<br><a href="http://wsgzao.github.io/post/hexo-guide/" target="_blank" rel="noopener">http://wsgzao.github.io/post/hexo-guide/</a></p>
<p>npm -g install hexo-cli<br>npm install hexo –save</p>
<h2 id="3-创建博客的目录"><a href="#3-创建博客的目录" class="headerlink" title="(3) 创建博客的目录"></a>(3) 创建博客的目录</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo init  hexo</span><br></pre></td></tr></table></figure>
<h2 id="4-创建一篇post"><a href="#4-创建一篇post" class="headerlink" title="(4)创建一篇post"></a>(4)创建一篇post</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd hexo;</span><br><span class="line">hexo n post &quot;title&quot;  &#x2F;&#x2F;生成文章</span><br></pre></td></tr></table></figure>

<h2 id="5-启动hexo服务器"><a href="#5-启动hexo服务器" class="headerlink" title="(5) 启动hexo服务器"></a>(5) 启动hexo服务器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo s  &#x2F;&#x2F; 启动server 本地预览</span><br><span class="line">&#x2F;&#x2F;访问 127.0.0.1:4000</span><br></pre></td></tr></table></figure>

<h2 id="6-生成静态文件"><a href="#6-生成静态文件" class="headerlink" title="(6) 生成静态文件."></a>(6) 生成静态文件.</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br></pre></td></tr></table></figure>
<p>通过hexo s预览的时候并不需要这一步,  由于这些静态文件部署到 github , github并不直接支持hexo的方式,github支持直接访问静态html文件,css文件的传统方式. (注意与jekyll的思路不一样)</p>
<h2 id="7-部署"><a href="#7-部署" class="headerlink" title="(7) 部署"></a>(7) 部署</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<h3 id="a-自动部署到git-推荐"><a href="#a-自动部署到git-推荐" class="headerlink" title="(a) 自动部署到git (推荐)"></a>(a) 自动部署到git (推荐)</h3><p>安装hexo的git插件, 参考<br><a href="http://wsgzao.github.io/post/hexo-guide/" target="_blank" rel="noopener">http://wsgzao.github.io/post/hexo-guide/</a></p>
<p>需要注意的是:  deploy的 方式 是git 不是github<br>参考的配置方式, 需要修改_config.yml </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repo: https:&#x2F;&#x2F;github.com&#x2F;frank0718&#x2F;frank0718.github.io.git    </span><br><span class="line">##如果是repo: git@github.com:username&#x2F;username.github.io.git 这样就自动使用ssh协议推送了 .</span><br><span class="line">  branch: master</span><br><span class="line">  message: hexo deploy</span><br></pre></td></tr></table></figure>

<p>参考<br><a href="http://">https://github.com/hexojs/hexo/issues/1040<br>https://github.com/hexojs/hexo/issues/1154</a></p>
<h3 id="b-手动部署到git"><a href="#b-手动部署到git" class="headerlink" title="(b)手动部署到git"></a>(b)手动部署到git</h3><p>hexo g 之后会生成public 目录, 把public目录手动复制到 user.github.io的repo中, 然后push .直接就可以访问了. </p>
<h2 id="8-安装主题"><a href="#8-安装主题" class="headerlink" title="(8) 安装主题"></a>(8) 安装主题</h2><p>安装jacman主题<br><a href="http://blog.fens.me/hexo-blog-github/" target="_blank" rel="noopener">http://blog.fens.me/hexo-blog-github/</a>  这个有点旧  pacman 已经404 .<br><a href="https://github.com/wuchong/jacman" target="_blank" rel="noopener">https://github.com/wuchong/jacman</a><br><a href="http://wsgzao.github.io/post/hexo-jacman/" target="_blank" rel="noopener">http://wsgzao.github.io/post/hexo-jacman/</a><br><a href="http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/" target="_blank" rel="noopener">http://wuchong.me/jacman/2014/11/20/how-to-use-jacman/</a></p>
<p>方法:</p>
<h3 id="1-git-clone-https-github-com-wuchong-jacman-git-themes-jacman"><a href="#1-git-clone-https-github-com-wuchong-jacman-git-themes-jacman" class="headerlink" title="(1)git clone https://github.com/wuchong/jacman.git themes/jacman"></a>(1)git clone <a href="https://github.com/wuchong/jacman.git" target="_blank" rel="noopener">https://github.com/wuchong/jacman.git</a> themes/jacman</h3><h3 id="2-config-yml"><a href="#2-config-yml" class="headerlink" title="(2)_config.yml"></a>(2)_config.yml</h3><p>中间修改主题的名字 为jacman</p>
<h3 id="3-hexo-clean-删除旧的静态文件"><a href="#3-hexo-clean-删除旧的静态文件" class="headerlink" title="(3)  hexo clean 删除旧的静态文件"></a>(3)  hexo clean 删除旧的静态文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@netease:~&#x2F;hexo# hexo clean </span><br><span class="line">INFO  Deleted database.</span><br><span class="line">INFO  Deleted public folder.</span><br></pre></td></tr></table></figure>
<p>hexo g;<br>hexo d;<br>重新发布 </p>
<h3 id="4-主题颜色更改"><a href="#4-主题颜色更改" class="headerlink" title="(4)主题颜色更改"></a>(4)主题颜色更改</h3><p>在博客的目录下输入下面指令<br>cd node_modules/hexo-renderer-stylus<br>npm install <a href="mailto:stylus@0.49.2">stylus@0.49.2</a>  #根据系统文件的权限不同，有的不需要加sudo<br>然后更改在主题目录下的_config.yml的 theme_color 下 theme 值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">### Theme Color </span><br><span class="line">theme_color:</span><br><span class="line">    theme: &#39;#2ca6cb&#39;    ##the defaut theme color is blue</span><br></pre></td></tr></table></figure>
<p>可以查看rgb的数值选个喜欢的颜色</p>
<h2 id="9-添加一些页面"><a href="#9-添加一些页面" class="headerlink" title="(9)添加一些页面"></a>(9)添加一些页面</h2><h3 id="1-命令手动生成自定义页面"><a href="#1-命令手动生成自定义页面" class="headerlink" title="1.命令手动生成自定义页面"></a>1.命令手动生成自定义页面</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo n page &quot;about&quot;</span><br></pre></td></tr></table></figure>
<h3 id="2-编辑hexo-source-about-index-md内容"><a href="#2-编辑hexo-source-about-index-md内容" class="headerlink" title="2.编辑hexo/source/about/index.md内容"></a>2.编辑hexo/source/about/index.md内容</h3><p>###3.修改themes/jacman/_config.yml文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">menu:</span><br><span class="line">  关于: &#x2F;about</span><br></pre></td></tr></table></figure>
<h2 id="10-修改post预设格式"><a href="#10-修改post预设格式" class="headerlink" title="(10)修改post预设格式"></a>(10)修改post预设格式</h2><p>建议按照个人习惯修改hexo\scaffolds中的post.md</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">title: &#123;&#123; title &#125;&#125;</span><br><span class="line">date: &#123;&#123; date &#125;&#125;</span><br><span class="line">categories:</span><br><span class="line">description:</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/12/18/nginx-errors-probes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/18/nginx-errors-probes/" class="post-title-link" itemprop="url">nginx-errors-probe</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-18 15:21:04" itemprop="dateCreated datePublished" datetime="2015-12-18T15:21:04+08:00">2015-12-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>是否在工作中遇到过各种的nginx错误,导致服务不可用? 未注意到配置文件的细节问题,导致配置不生效? 遇到log中的提示,无法快速定位问题? 本文旨在提供一些方法或者思路,希望为大家解决各自的问题提供一些帮助.++</p>
<p>(1)debug<br>工欲善其事,必先利其器.<br>测试阶段找不到问题的原因时,开启error_log debug的开关,然后去看error_log的内容,你会收获很多.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_log  &#x2F;path&#x2F;to&#x2F;log debug;</span><br></pre></td></tr></table></figure>

<p>(2) Nginx Error 413 Request Entity Too Large</p>
<p>由于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">client_max_body_size 值默认是1m;</span><br></pre></td></tr></table></figure>
<p>所以在一些需要上传大文件或者请求的数据量比较大的场景下,需要适当的调整这个值.</p>
<p>(3)502/504错误</p>
<p>error_log一般会显示upstream timed out (110: Connection timed out)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2014&#x2F;08&#x2F;14 10:23:15 [error] 19210#0: *104643398 upstream timed out (110: Connection timed out) while reading response header from upstream,</span><br></pre></td></tr></table></figure>
<p>说明本层代理是ok的,要去找upstream指向的ip的http服务是否可用;http服务可用但是有ip或者port的限制,使用telnet ip port辅助查看结果</p>
<p>(4) 日志记录中HTTP状态码出现499错误<br>默认情况下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy_ignore_client_abort off，</span><br></pre></td></tr></table></figure>
<p>在请求过程中如果client主动关闭连接或者客户端网络断掉，那么 Nginx 会记录 499<br>如果使用了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy_ignore_client_abort on</span><br></pre></td></tr></table></figure>
<p>不主动关闭客户端的连接;那么客户端主动断掉连接之后，Nginx 会等待后端处理完(或者超时)，然后记录后端返回的信息到日志。所以，如果后端返回 200， 就记录200 ；如果后端放回5XX ，那么就记录 5XX .如果超时(默认60s，可以用 proxy_read_timeout 设置)，Nginx 会主动断开连接，记录 504。</p>
<p>(5) Nginx 403 error: directory index of [folder] is forbidden<br>Error_log 如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2014&#x2F;08&#x2F;21 11:59:26 [error] 4229#0: *38 directory index of &quot;&#x2F;home&#x2F;xxxx&quot; is forbidden, client: 127.0.0.1, server: abc.com, request: &quot;HEAD &#x2F; HTTP&#x2F;1.1&quot;, host: &quot;abc.com&quot;</span><br></pre></td></tr></table></figure>
<p>原因是访问这个域名的首页时由于没有配置首页的rewrite,nginx默认会去找目录中的index.html,所以解决方法有</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a)	指定首页对应的文件如,rewrite ^&#x2F;*$ &#x2F;somefile break;</span><br><span class="line">b)	在目录中建立index.html文件</span><br><span class="line">c)	配置autoindex on;这样做用户在访问首页的时候会列出这个目录下的所有文件,强烈建议不要这么做,除非有特殊需求.</span><br></pre></td></tr></table></figure>



<p>(6)Permission denied<br>Error_log如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2014&#x2F;09&#x2F;03 12:53:49 [error] 22402#0: *11399428976 open()  failed (13: Permission denied), client:</span><br></pre></td></tr></table></figure>
<p>由于nginx默认用户是nobody(强烈建议不要用root用户);文件的权限如下<br>-rwxr-x— 1 root root 160 Sep 3 12:44 allphoto.xml<br>Nobody没有read的权限,所以无法打开,当然就无法访问.改成644就可以了<br>-rw-r–r– 1 root root 160 Sep 3 12:44 allphoto.xml</p>
<p>(7) rewrite 死循环<br>Error_log如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2014&#x2F;09&#x2F;10 11:02:04 [error] 17989#0: *6 rewrite or internal redirection cycle while processing &quot;&#x2F;test.html&quot;, client: 127.0.0.1, server: abc.com, request: &quot;HEAD &#x2F; HTTP&#x2F;1.1&quot;, host: &quot;abc.com&quot;</span><br></pre></td></tr></table></figure>
<p>提示rewrite或者内部重定向出现循环.解决办法:找到/test.html对应的配置,最后加上last或者break</p>
<p>(8) proxy_pass 注意点</p>
<p>proxy_pass” cannot have URI part in location given by regular expression, or inside named location, or inside “if” statement, or inside “limit_except” block …<br>eg:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location ~* \.(jsp|do)$&#123;</span><br><span class="line">index index.jsp;</span><br><span class="line">proxy_pass http:&#x2F;&#x2F;localhost:8080&#x2F;shop_goods;</span><br><span class="line">proxy_set_header X-Real-IP $remote_addr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当location中配置的有正则表达式,或在命名location中,或在if语句,或在limit_except 块中,proxy_pass 不能有URI的部分,只能是proxy_pass <a href="http://ip:port的形式">http://ip:port的形式</a>.</p>
<p>(9) nginx配置chunked开关<br>有时候用curl –I 可以看到reponse的header里面会有<br><code>Transfer-Encoding:chunked</code><br>这一项,它表明采用chunked编码方式来进行报文体的传输。chunked编码是HTTP/1.1 RFC里定义的一种编码方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chunked编码的基本原理是将大块数据分解成多块小数据，每块都可以自指定长度。这样就能更快的让页面呈现出来,数据被截成许多小片段，浏览器分段解析。但是在一些场景中,要避免分块传输,client希望请求的数据一次性传输完毕,就需要设置</span><br></pre></td></tr></table></figure>
<p><code>chunked_transfer_encoding off;</code></p>
<p>(10)关于正则<br>nginx location/if 中的正则表达式子模式(subpatterns)与逆向引用(Back references)<br>比如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">location ~ ^&#x2F;somedir&#x2F;((abc)|(.*))&#x2F;$</span><br></pre></td></tr></table></figure>
<p>那么$1=abc.<em>,$2=abc,$3=.</em>,它们的序号是由左括号的顺序决定的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2015/12/16/github-blog-jekyll/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2015/12/16/github-blog-jekyll/" class="post-title-link" itemprop="url">github-blog-jekyll</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2015-12-16 15:21:04" itemprop="dateCreated datePublished" datetime="2015-12-16T15:21:04+08:00">2015-12-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-20 15:38:12" itemprop="dateModified" datetime="2020-07-20T15:38:12+08:00">2020-07-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p> 搭建github博客 </p>
<p><strong>在国内的环境装软件真是TM的艰辛</strong></p>
<p>先列出环境 Ubuntu12.04 i386</p>
<h2 id="1-安装rvm"><a href="#1-安装rvm" class="headerlink" title="(1) 安装rvm"></a>(1) 安装rvm</h2><p>按照google搜出来的教程.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -L https:&#x2F;&#x2F;get.rvm.io | bash -s stable</span><br></pre></td></tr></table></figure>
<p> 根本没反应好不好,<br>只好去vps上把<a href="https://get.rvm.io代码拿到" target="_blank" rel="noopener">https://get.rvm.io代码拿到</a> push到git 上,或者copy到本地. 执行<br><code>bash rvm.sh stable</code></p>
<h2 id="2-保证github-或者bitbucket-可用"><a href="#2-保证github-或者bitbucket-可用" class="headerlink" title="(2) 保证github 或者bitbucket 可用."></a>(2) 保证github 或者bitbucket 可用.</h2><p>rvm.sh 要从github 或者 bitbucket.org取代码.</p>
<h2 id="3-配置-etc-profile-让系统找到rvm的位置"><a href="#3-配置-etc-profile-让系统找到rvm的位置" class="headerlink" title="(3)配置 /etc/profile 让系统找到rvm的位置."></a>(3)配置 /etc/profile 让系统找到rvm的位置.</h2><p>rvm安装完成后,<br>默认rvm 装在 /usr/local/rvm,<br>编辑/etc/profile, 最后加入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH&#x3D;&#x2F;usr&#x2F;local&#x2F;..&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure>
<p>安装完成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rvm -v</span><br><span class="line">rvm 1.26.11</span><br></pre></td></tr></table></figure>
<h2 id="4-配置ubuntu的源"><a href="#4-配置ubuntu的源" class="headerlink" title="(4)配置ubuntu的源"></a>(4)配置ubuntu的源</h2><p>使用souhu的12.04的源.<br>apt-get update  ,<br>因为默认的源 没法更新libsqlite ,  坑爹.  使用搜狐的就可以了.</p>
<p>rvm requirements 查看依赖,并自动解决依赖.<br>执行之后下面的都装上了,为安装ruby做准备,又离成功近了唉</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get --no-install-recommends --yes install gawk libyaml-dev libsqlite3-dev sqlite3 libgdbm-dev libtool bison</span><br></pre></td></tr></table></figure>

<h2 id="5-第一次安装ruby-fail"><a href="#5-第一次安装ruby-fail" class="headerlink" title="(5)第一次安装ruby (fail)"></a>(5)第一次安装ruby (fail)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rvm install 2.0.0</span><br><span class="line">No binary rubies available for: ubuntu&#x2F;12.04&#x2F;i386&#x2F;ruby-2.0.0-p643.</span><br></pre></td></tr></table></figure>

<p>还要编译安装.<br>….中间省略</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Installing Ruby from source to: &#x2F;usr&#x2F;local&#x2F;rvm&#x2F;rubies&#x2F;ruby-2.0.0-p643, this may take a while depending on your cpu(s)...</span><br><span class="line"></span><br><span class="line">ruby-2.0.0-p643 - #extracting ruby-2.0.0-p643 to &#x2F;usr&#x2F;local&#x2F;rvm&#x2F;src&#x2F;ruby-2.0.0-p643....</span><br><span class="line">ruby-2.0.0-p643 - #configuring..................................................</span><br><span class="line">ruby-2.0.0-p643 - #post-configuration..</span><br><span class="line">ruby-2.0.0-p643 - #compiling.............................................................................</span><br><span class="line">ruby-2.0.0-p643 - #installing..............................</span><br><span class="line">ruby-2.0.0-p643 - #making binaries executable..</span><br><span class="line">ruby-2.0.0-p643 - #downloading rubygems-2.4.8  卡住不动了</span><br></pre></td></tr></table></figure>
<p>好吧.ctrl c取消了安装过程,downloading是在走不动啊 </p>
<h2 id="6-第一次配置ruby-fail"><a href="#6-第一次配置ruby-fail" class="headerlink" title="(6)第一次配置ruby (fail)"></a>(6)第一次配置ruby (fail)</h2><p>rvm 2.0.0 –default<br>报错</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Gemset &#39;&#39; does not exist, &#39;rvm ruby-2.0.0-p643 do rvm gemset create &#39; first, or append &#39;--create&#39;.</span><br></pre></td></tr></table></figure>
<p>看来ruby 和gem是需要同时安装的.<br>具体怎么单独安装gem , 查不到…</p>
<p>痛定思痛. 再去google. </p>
<h2 id="7-第二次安装ruby-success"><a href="#7-第二次安装ruby-success" class="headerlink" title="(7)第二次安装ruby (success)"></a>(7)第二次安装ruby (success)</h2><p>由于rvm安装ruby时,使用的是国外的源, 速度不忍直视.</p>
<p>修改rvm的源 为taobao的 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sed -i -E &#39;s!https?:&#x2F;&#x2F;cache.ruby-lang.org&#x2F;pub&#x2F;ruby!https:&#x2F;&#x2F;ruby.taobao.org&#x2F;mirrors&#x2F;ruby!&#39;$rvm_path&#x2F;config&#x2F;db</span><br></pre></td></tr></table></figure>
<p>这里的rvmpath就是/usr/local/rvm/目录.</p>
<p>rvm install 2.2.0</p>
<p>完成. 速度还挺快. </p>
<p>当做默认的rvm版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> rvm use 2.2.0 --default</span><br><span class="line">Using &#x2F;usr&#x2F;local&#x2F;rvm&#x2F;gems&#x2F;ruby-2.2.0</span><br></pre></td></tr></table></figure>

<p>查询已经安装的ruby<br>rvm list<br>卸载一个已安装版本<br>rvm remove 2.0.0 </p>
<p>ruby -v<br>ruby 2.2.0p0 (2014-12-25 revision 49005) [i686-linux]</p>
<p>查看gem的版本<br> gem -v<br>2.4.8</p>
<p>走到这一步,泪流满面,感谢方校长….</p>
<h2 id="8-配置gem源"><a href="#8-配置gem源" class="headerlink" title="(8) 配置gem源"></a>(8) 配置gem源</h2><p>速度问题,必须修改 gem的源 为淘宝的 . </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gem sources --add https:&#x2F;&#x2F;ruby.taobao.org&#x2F; --remove https:&#x2F;&#x2F;rubygems.org&#x2F;</span><br><span class="line">$ gem sources -l</span><br><span class="line">*** CURRENT SOURCES ***</span><br><span class="line"></span><br><span class="line">https:&#x2F;&#x2F;ruby.taobao.org</span><br></pre></td></tr></table></figure>

<p>请确保只有 ruby.taobao.org</p>
<p>有选择的安装rails<br>$ gem install rails<br><a href="https://ruby.taobao.org/" target="_blank" rel="noopener">https://ruby.taobao.org/</a></p>
<h2 id="9-安装-jeklly-终于来了"><a href="#9-安装-jeklly-终于来了" class="headerlink" title="(9)安装 jeklly (终于来了)"></a>(9)安装 jeklly (终于来了)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install jekyll -V</span><br></pre></td></tr></table></figure>
<p>第一次装报ssl的错误, 查了一大堆 也没看出来咋搞.<br>具体参考:<br><a href="https://gist.github.com/luislavena/f064211759ee0f806c88" target="_blank" rel="noopener">https://gist.github.com/luislavena/f064211759ee0f806c88</a><br><a href="https://raw.githubusercontent.com/rubygems/rubygems/master/lib/rubygems/ssl_certs/AddTrustExternalCARoot-2048.pem" target="_blank" rel="noopener">https://raw.githubusercontent.com/rubygems/rubygems/master/lib/rubygems/ssl_certs/AddTrustExternalCARoot-2048.pem</a></p>
<p><a href="http://blacktha.com/2015/07/06/tech/Ruby/" target="_blank" rel="noopener">http://blacktha.com/2015/07/06/tech/Ruby/</a><br><a href="http://yunkus.com/article/ziyuan/287.html" target="_blank" rel="noopener">http://yunkus.com/article/ziyuan/287.html</a></p>
<p>等了一会再装就ok了(网络问题?). </p>
<p>jekyll -v<br>jekyll 3.0.1</p>
<h2 id="10-搭建博客"><a href="#10-搭建博客" class="headerlink" title="(10)  搭建博客"></a>(10)  搭建博客</h2><p>前提:<br>按照github的提示一步步建立自己的repo<br>然后参考了一个博客,使用现成的模板</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;plusjade&#x2F;jekyll-bootstrap.git</span><br><span class="line">jekyll server</span><br></pre></td></tr></table></figure>

<p>启动一个本地的server . </p>
<p>创建一篇post</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rake post title&#x3D;&quot;Hello World&quot;</span><br><span class="line">rake page name&#x3D;&quot;about.md&quot;</span><br></pre></td></tr></table></figure>
<p>然后可以把这个目录的内容cp到自己的github项目里 ,<br>需要注意<br>修改文件：_config.yml，设置production_url</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">~ vi _config.yml</span><br><span class="line">production_url : http:&#x2F;&#x2F;frank0718.github.io</span><br><span class="line"></span><br><span class="line">git add -all</span><br><span class="line">git commit -m &quot;add &quot;</span><br><span class="line">git  push  origin master</span><br></pre></td></tr></table></figure>
<p>然后就能看到博客了 </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">31</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
